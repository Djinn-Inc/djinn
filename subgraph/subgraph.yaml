specVersion: 1.0.0
indexerHints:
  prune: auto
schema:
  file: ./schema.graphql
dataSources:
  # --- SignalCommitment ---
  - kind: ethereum
    name: SignalCommitment
    network: base
    source:
      address: "0x0000000000000000000000000000000000000001"
      abi: SignalCommitment
      startBlock: 0
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.9
      language: wasm/assemblyscript
      entities:
        - Signal
        - Genius
        - ProtocolStats
      abis:
        - name: SignalCommitment
          file: ./abis/SignalCommitment.json
      eventHandlers:
        - event: SignalCommitted(indexed uint256,indexed address,string,uint256,uint256,uint256)
          handler: handleSignalCommitted
        - event: SignalVoided(indexed uint256,indexed address)
          handler: handleSignalVoided
        - event: SignalStatusUpdated(indexed uint256,uint8)
          handler: handleSignalStatusUpdated
      file: ./src/signal-commitment.ts

  # --- Escrow ---
  - kind: ethereum
    name: Escrow
    network: base
    source:
      address: "0x0000000000000000000000000000000000000002"
      abi: Escrow
      startBlock: 0
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.9
      language: wasm/assemblyscript
      entities:
        - Purchase
        - Idiot
        - Genius
        - Signal
        - ProtocolStats
      abis:
        - name: Escrow
          file: ./abis/Escrow.json
      eventHandlers:
        - event: Deposited(indexed address,uint256)
          handler: handleDeposited
        - event: Withdrawn(indexed address,uint256)
          handler: handleWithdrawn
        - event: SignalPurchased(indexed uint256,indexed address,uint256,uint256,uint256,uint256)
          handler: handleSignalPurchased
        - event: Refunded(indexed address,indexed address,uint256,uint256)
          handler: handleRefunded
        - event: OutcomeUpdated(indexed uint256,uint8)
          handler: handleOutcomeUpdated
      file: ./src/escrow.ts

  # --- Collateral ---
  - kind: ethereum
    name: Collateral
    network: base
    source:
      address: "0x0000000000000000000000000000000000000003"
      abi: Collateral
      startBlock: 0
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.9
      language: wasm/assemblyscript
      entities:
        - CollateralPosition
        - Genius
        - ProtocolStats
      abis:
        - name: Collateral
          file: ./abis/Collateral.json
      eventHandlers:
        - event: Deposited(indexed address,uint256)
          handler: handleCollateralDeposited
        - event: Withdrawn(indexed address,uint256)
          handler: handleCollateralWithdrawn
        - event: Locked(indexed uint256,indexed address,uint256)
          handler: handleCollateralLocked
        - event: Released(indexed uint256,indexed address,uint256)
          handler: handleCollateralReleased
        - event: Slashed(indexed address,uint256,indexed address)
          handler: handleCollateralSlashed
      file: ./src/collateral.ts

  # --- Account ---
  - kind: ethereum
    name: Account
    network: base
    source:
      address: "0x0000000000000000000000000000000000000004"
      abi: Account
      startBlock: 0
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.9
      language: wasm/assemblyscript
      entities:
        - Account
        - Genius
        - Idiot
      abis:
        - name: Account
          file: ./abis/Account.json
      eventHandlers:
        - event: PurchaseRecorded(indexed address,indexed address,uint256,uint256)
          handler: handlePurchaseRecorded
        - event: OutcomeRecorded(indexed address,indexed address,uint256,uint8)
          handler: handleOutcomeRecorded
        - event: NewCycleStarted(indexed address,indexed address,uint256)
          handler: handleNewCycleStarted
        - event: SettledChanged(indexed address,indexed address,bool)
          handler: handleSettledChanged
      file: ./src/account.ts

  # --- Audit ---
  - kind: ethereum
    name: Audit
    network: base
    source:
      address: "0x0000000000000000000000000000000000000005"
      abi: Audit
      startBlock: 0
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.9
      language: wasm/assemblyscript
      entities:
        - AuditResult
        - Genius
        - Idiot
        - Account
        - ProtocolStats
      abis:
        - name: Audit
          file: ./abis/Audit.json
      eventHandlers:
        - event: AuditSettled(indexed address,indexed address,uint256,int256,uint256,uint256,uint256)
          handler: handleAuditSettled
        - event: EarlyExitSettled(indexed address,indexed address,uint256,int256,uint256)
          handler: handleEarlyExitSettled
      file: ./src/audit.ts

  # --- CreditLedger ---
  - kind: ethereum
    name: CreditLedger
    network: base
    source:
      address: "0x0000000000000000000000000000000000000006"
      abi: CreditLedger
      startBlock: 0
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.9
      language: wasm/assemblyscript
      entities:
        - CreditBalance
        - Idiot
        - ProtocolStats
      abis:
        - name: CreditLedger
          file: ./abis/CreditLedger.json
      eventHandlers:
        - event: CreditsMinted(indexed address,uint256)
          handler: handleCreditsMinted
        - event: CreditsBurned(indexed address,uint256)
          handler: handleCreditsBurned
      file: ./src/credit-ledger.ts
